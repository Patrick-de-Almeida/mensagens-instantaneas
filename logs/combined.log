2025-05-15 21:50:16 [info]: Conexão com o banco de dados estabelecida com sucesso
2025-05-15 21:50:16 [info]: Biblioteca de chat inicializada com sucesso
2025-05-15 21:50:16 [info]: === INICIANDO EXEMPLO DE USO DA BIBLIOTECA ===
2025-05-15 21:50:16 [info]: 1. Criando usuários...
2025-05-15 21:50:16 [info]: Usuário criado com sucesso: joao123
2025-05-15 21:50:16 [info]: Usuário criado com sucesso: maria456
2025-05-15 21:50:16 [info]: Usuário criado com sucesso: carlos789
2025-05-15 21:50:16 [info]: Usuários criados com sucesso: joao123, maria456, carlos789
2025-05-15 21:50:16 [info]: 2. Atualizando status dos usuários...
2025-05-15 21:50:16 [info]: Status do usuário joao123 atualizado para: online
2025-05-15 21:50:16 [info]: Status do usuário maria456 atualizado para: online
2025-05-15 21:50:16 [info]: Status dos usuários atualizados
2025-05-15 21:50:16 [info]: 3. Criando chat individual...
2025-05-15 21:50:16 [info]: Chat individual criado com sucesso
2025-05-15 21:50:16 [info]: Chat individual criado: 68268bc8a6d2403fa3a6362a
2025-05-15 21:50:16 [info]: 4. Criando chat em grupo...
2025-05-15 21:50:16 [info]: Chat em grupo criado com sucesso
2025-05-15 21:50:16 [info]: Chat em grupo criado: Grupo de Amigos (68268bc8a6d2403fa3a6362c)
2025-05-15 21:50:16 [info]: 5. Enviando mensagens no chat individual...
2025-05-15 21:50:17 [info]: Mensagem enviada com sucesso no chat 68268bc8a6d2403fa3a6362a
2025-05-15 21:50:17 [info]: Mensagem enviada com sucesso no chat 68268bc8a6d2403fa3a6362a
2025-05-15 21:50:17 [info]: Mensagens enviadas no chat individual
2025-05-15 21:50:17 [info]: 6. Enviando mensagens no chat em grupo...
2025-05-15 21:50:17 [info]: Mensagem enviada com sucesso no chat 68268bc8a6d2403fa3a6362c
2025-05-15 21:50:17 [info]: Mensagem enviada com sucesso no chat 68268bc8a6d2403fa3a6362c
2025-05-15 21:50:17 [info]: Mensagens enviadas no chat em grupo
2025-05-15 21:50:17 [info]: 7. Buscando mensagens do chat individual...
2025-05-15 21:50:17 [info]: Mensagens encontradas no chat individual: 2
2025-05-15 21:50:17 [info]: - Maria Souza: Olá, João! Estou bem, e você?
2025-05-15 21:50:17 [info]: - João Silva: Olá, Maria! Como você está?
2025-05-15 21:50:17 [info]: 8. Marcando mensagens como lidas...
2025-05-15 21:50:17 [info]: 1 mensagens marcadas como lidas no chat 68268bc8a6d2403fa3a6362a
2025-05-15 21:50:17 [info]: 1 mensagens marcadas como lidas
2025-05-15 21:50:17 [info]: 9. Buscando chats do usuário...
2025-05-15 21:50:17 [info]: Chats encontrados para João Silva: 2
2025-05-15 21:50:17 [info]: - Grupo: Grupo de Amigos (68268bc8a6d2403fa3a6362c)
2025-05-15 21:50:17 [info]: - Individual: Chat individual (68268bc8a6d2403fa3a6362a)
2025-05-15 21:50:17 [info]: 10. Excluindo uma mensagem...
2025-05-15 21:50:17 [info]: Mensagem 68268bc8a6d2403fa3a6362e apagada com sucesso
2025-05-15 21:50:17 [info]: Mensagem excluída com sucesso
2025-05-15 21:50:17 [info]: === EXEMPLO CONCLUÍDO COM SUCESSO ===
2025-05-15 21:50:17 [warn]: MongoDB desconectado
2025-05-15 21:50:17 [info]: Desconectado do banco de dados com sucesso
2025-05-19 19:40:17 [info]: Conexão com o banco de dados estabelecida com sucesso
2025-05-19 19:40:17 [info]: Biblioteca de chat inicializada com sucesso
2025-05-19 19:40:17 [info]: === INICIANDO EXEMPLO DE USO DA BIBLIOTECA ===
2025-05-19 19:40:17 [info]: 1. Criando usuários...
2025-05-19 19:40:17 [error]: Error: Nome de usuário já está em uso
    at userSchema.statics.createUser (C:\Users\Trick\Desktop\web2\src\models\User.js:81:27)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ChatLibrary.createUser (C:\Users\Trick\Desktop\web2\src\index.js:75:14)
    at async executeExample (C:\Users\Trick\Desktop\web2\src\example.js:38:25)
2025-05-19 19:40:17 [error]: Error: Nome de usuário já está em uso
    at userSchema.statics.createUser (C:\Users\Trick\Desktop\web2\src\models\User.js:81:27)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ChatLibrary.createUser (C:\Users\Trick\Desktop\web2\src\index.js:75:14)
    at async executeExample (C:\Users\Trick\Desktop\web2\src\example.js:39:25)
2025-05-19 19:40:17 [error]: Error: Nome de usuário já está em uso
    at userSchema.statics.createUser (C:\Users\Trick\Desktop\web2\src\models\User.js:81:27)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ChatLibrary.createUser (C:\Users\Trick\Desktop\web2\src\index.js:75:14)
    at async executeExample (C:\Users\Trick\Desktop\web2\src\example.js:40:25)
2025-05-19 19:40:17 [error]: Erro durante a execução do exemplo:
2025-05-19 19:40:17 [warn]: MongoDB desconectado
2025-05-19 19:40:17 [info]: Desconectado do banco de dados com sucesso
2025-05-19 20:42:00 [info]: Conexão com o banco de dados estabelecida com sucesso
2025-05-19 20:42:00 [info]: Biblioteca de chat inicializada com sucesso
2025-05-19 20:42:44 [info]: Usuário criado com sucesso: Patrick
2025-05-19 20:44:17 [info]: Chat individual criado com sucesso
2025-05-19 20:44:17 [info]: 0 mensagens marcadas como lidas no chat 682bc2511e6590aa0b1b3669
2025-05-19 20:44:30 [info]: Mensagem enviada com sucesso no chat 682bc2511e6590aa0b1b3669
2025-05-19 20:44:30 [info]: 0 mensagens marcadas como lidas no chat 682bc2511e6590aa0b1b3669
2025-05-19 20:45:05 [info]: Chat individual já existe entre os usuários: 682bc1f41e6590aa0b1b3665, 68268bc8a6d2403fa3a63623
2025-05-19 20:45:05 [info]: 0 mensagens marcadas como lidas no chat 682bc2511e6590aa0b1b3669
2025-05-19 20:45:14 [info]: Mensagem enviada com sucesso no chat 682bc2511e6590aa0b1b3669
2025-05-19 20:45:14 [info]: 0 mensagens marcadas como lidas no chat 682bc2511e6590aa0b1b3669
2025-05-19 20:45:32 [error]: Error: Status inválido. Use: online, offline ou away
    at userSchema.statics.updateStatus (C:\Users\Trick\Desktop\web2\src\models\User.js:120:13)
    at ChatLibrary.updateUserStatus (C:\Users\Trick\Desktop\web2\src\index.js:117:25)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async C:\Users\Trick\Desktop\web2\src\cli.js:611:28
2025-05-19 20:46:16 [info]: Status do usuário Patrick atualizado para: online
2025-05-19 20:46:36 [info]: Status do usuário Patrick atualizado para: offline
2025-05-19 20:46:50 [info]: Status do usuário Patrick atualizado para: online
2025-05-19 20:46:57 [info]: Status do usuário Patrick atualizado para: offline
2025-05-19 20:47:13 [info]: Status do usuário carlos789 atualizado para: online
2025-05-19 20:47:23 [info]: 2 mensagens marcadas como lidas no chat 682bc2511e6590aa0b1b3669
2025-05-19 20:47:31 [error]: TypeError: Class constructor ObjectId cannot be invoked without 'new'
    at messageSchema.statics.findUnreadByUser (C:\Users\Trick\Desktop\web2\src\models\Message.js:206:41)
    at ChatLibrary.getUnreadMessages (C:\Users\Trick\Desktop\web2\src\index.js:283:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async showUnreadMessages (C:\Users\Trick\Desktop\web2\src\cli.js:635:24)
2025-05-19 20:48:01 [info]: Status do usuário carlos789 atualizado para: offline
2025-05-19 20:48:01 [warn]: MongoDB desconectado
2025-06-29 17:06:49 [error]: Falha ao conectar ao banco de dados
2025-06-29 17:06:49 [error]: MongooseServerSelectionError: Could not connect to any servers in your MongoDB Atlas cluster. One common reason is that you're trying to access the database from an IP that isn't whitelisted. Make sure your current IP address is on your Atlas cluster's IP whitelist: https://www.mongodb.com/docs/atlas/security-whitelist/
    at _handleConnectionErrors (C:\Users\Trick\Documents\web2\node_modules\mongoose\lib\connection.js:816:11)
    at NativeConnection.openUri (C:\Users\Trick\Documents\web2\node_modules\mongoose\lib\connection.js:791:11)
    at async connectToDatabase (C:\Users\Trick\Documents\web2\src\config\database.js:8:5)
    at async ChatLibrary.connect (C:\Users\Trick\Documents\web2\src\index.js:35:7)
    at async startServer (C:\Users\Trick\Documents\web2\src\app.js:89:9)
2025-06-29 17:06:49 [info]: Conectado ao banco de dados
2025-06-29 17:06:49 [info]: Servidor rodando na porta 3000
2025-06-29 17:10:35 [error]: Falha ao conectar ao banco de dados
2025-06-29 17:10:35 [error]: MongooseServerSelectionError: Could not connect to any servers in your MongoDB Atlas cluster. One common reason is that you're trying to access the database from an IP that isn't whitelisted. Make sure your current IP address is on your Atlas cluster's IP whitelist: https://www.mongodb.com/docs/atlas/security-whitelist/
    at _handleConnectionErrors (C:\Users\Trick\Documents\web2\node_modules\mongoose\lib\connection.js:816:11)
    at NativeConnection.openUri (C:\Users\Trick\Documents\web2\node_modules\mongoose\lib\connection.js:791:11)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async connectToDatabase (C:\Users\Trick\Documents\web2\src\config\database.js:8:5)
    at async ChatLibrary.connect (C:\Users\Trick\Documents\web2\src\index.js:35:7)
    at async ChatLibrary.ensureConnection (C:\Users\Trick\Documents\web2\src\index.js:313:7)
    at async ChatLibrary.createUser (C:\Users\Trick\Documents\web2\src\index.js:74:7)
    at async C:\Users\Trick\Documents\web2\src\routes\auth.js:105:24
2025-06-29 17:10:45 [error]: MongooseError: Operation `users.insertOne()` buffering timed out after 10000ms
    at Timeout.<anonymous> (C:\Users\Trick\Documents\web2\node_modules\mongoose\lib\drivers\node-mongodb-native\collection.js:185:23)
    at listOnTimeout (node:internal/timers:594:17)
    at process.processTimers (node:internal/timers:529:7)
2025-06-29 17:13:30 [info]: Conexão com o banco de dados estabelecida com sucesso
2025-06-29 17:13:30 [info]: Biblioteca de chat inicializada com sucesso
2025-06-29 17:13:30 [info]: Conectado ao banco de dados
2025-06-29 17:13:30 [info]: Servidor rodando na porta 3000
2025-06-29 17:20:54 [info]: Status do usuário joao123 atualizado para: online
2025-06-29 17:20:54 [error]: TypeError: Class constructor ObjectId cannot be invoked without 'new'
    at messageSchema.statics.findUnreadByUser (C:\Users\Trick\Documents\web2\src\models\Message.js:206:41)
    at ChatLibrary.getUnreadMessages (C:\Users\Trick\Documents\web2\src\index.js:283:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async C:\Users\Trick\Documents\web2\src\routes\chats.js:20:30
2025-06-29 17:21:06 [info]: 1 mensagens marcadas como lidas no chat 68268bc8a6d2403fa3a6362a
2025-06-29 17:21:14 [info]: Mensagem enviada com sucesso no chat 68268bc8a6d2403fa3a6362a
2025-06-29 17:21:30 [info]: Status do usuário joao123 atualizado para: offline
2025-06-29 17:21:45 [info]: Status do usuário maria456 atualizado para: online
2025-06-29 17:21:45 [error]: TypeError: Class constructor ObjectId cannot be invoked without 'new'
    at messageSchema.statics.findUnreadByUser (C:\Users\Trick\Documents\web2\src\models\Message.js:206:41)
    at ChatLibrary.getUnreadMessages (C:\Users\Trick\Documents\web2\src\index.js:283:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async C:\Users\Trick\Documents\web2\src\routes\chats.js:20:30
2025-06-29 17:21:55 [info]: 1 mensagens marcadas como lidas no chat 68268bc8a6d2403fa3a6362a
2025-06-29 17:22:10 [info]: Mensagem enviada com sucesso no chat 68268bc8a6d2403fa3a6362a
2025-06-29 17:22:30 [error]: TypeError: Class constructor ObjectId cannot be invoked without 'new'
    at messageSchema.statics.findUnreadByUser (C:\Users\Trick\Documents\web2\src\models\Message.js:206:41)
    at ChatLibrary.getUnreadMessages (C:\Users\Trick\Documents\web2\src\index.js:283:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async C:\Users\Trick\Documents\web2\src\routes\chats.js:20:30
2025-06-29 17:22:32 [info]: 2 mensagens marcadas como lidas no chat 68268bc8a6d2403fa3a6362c
2025-06-29 17:22:47 [error]: TypeError: Class constructor ObjectId cannot be invoked without 'new'
    at messageSchema.statics.findUnreadByUser (C:\Users\Trick\Documents\web2\src\models\Message.js:206:41)
    at ChatLibrary.getUnreadMessages (C:\Users\Trick\Documents\web2\src\index.js:283:28)
    at async C:\Users\Trick\Documents\web2\src\routes\messages.js:131:24
2025-06-29 17:22:51 [info]: Status do usuário maria456 atualizado para: away
2025-06-29 17:22:54 [info]: Status do usuário maria456 atualizado para: online
2025-06-29 17:22:57 [error]: TypeError: Class constructor ObjectId cannot be invoked without 'new'
    at messageSchema.statics.findUnreadByUser (C:\Users\Trick\Documents\web2\src\models\Message.js:206:41)
    at ChatLibrary.getUnreadMessages (C:\Users\Trick\Documents\web2\src\index.js:283:28)
    at async C:\Users\Trick\Documents\web2\src\routes\messages.js:131:24
2025-06-29 17:23:07 [info]: Status do usuário maria456 atualizado para: offline
2025-06-29 17:23:22 [info]: Status do usuário joao123 atualizado para: online
2025-06-29 17:23:22 [error]: TypeError: Class constructor ObjectId cannot be invoked without 'new'
    at messageSchema.statics.findUnreadByUser (C:\Users\Trick\Documents\web2\src\models\Message.js:206:41)
    at ChatLibrary.getUnreadMessages (C:\Users\Trick\Documents\web2\src\index.js:283:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async C:\Users\Trick\Documents\web2\src\routes\chats.js:20:30
2025-06-29 17:23:25 [info]: 1 mensagens marcadas como lidas no chat 68268bc8a6d2403fa3a6362a
2025-06-29 17:23:45 [info]: Status do usuário joao123 atualizado para: offline
2025-06-29 17:24:37 [info]: Usuário criado com sucesso: arthur_lima
2025-06-29 17:24:37 [error]: TypeError: Class constructor ObjectId cannot be invoked without 'new'
    at messageSchema.statics.findUnreadByUser (C:\Users\Trick\Documents\web2\src\models\Message.js:206:41)
    at ChatLibrary.getUnreadMessages (C:\Users\Trick\Documents\web2\src\index.js:283:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async C:\Users\Trick\Documents\web2\src\routes\chats.js:20:30
2025-06-29 17:24:53 [error]: TypeError: Class constructor ObjectId cannot be invoked without 'new'
    at messageSchema.statics.findUnreadByUser (C:\Users\Trick\Documents\web2\src\models\Message.js:206:41)
    at ChatLibrary.getUnreadMessages (C:\Users\Trick\Documents\web2\src\index.js:283:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async C:\Users\Trick\Documents\web2\src\routes\chats.js:20:30
2025-06-29 17:25:05 [error]: Error: Usuário 'João Silva' não encontrado
    at userSchema.statics.findByUsername (C:\Users\Trick\Documents\web2\src\models\User.js:101:21)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async ChatLibrary.findUserByUsername (C:\Users\Trick\Documents\web2\src\index.js:89:14)
    at async C:\Users\Trick\Documents\web2\src\routes\users.js:43:24
2025-06-29 17:25:16 [error]: TypeError: Class constructor ObjectId cannot be invoked without 'new'
    at messageSchema.statics.findUnreadByUser (C:\Users\Trick\Documents\web2\src\models\Message.js:206:41)
    at ChatLibrary.getUnreadMessages (C:\Users\Trick\Documents\web2\src\index.js:283:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async C:\Users\Trick\Documents\web2\src\routes\chats.js:20:30
2025-06-29 17:25:25 [info]: Chat individual criado com sucesso
2025-06-29 17:25:26 [info]: 0 mensagens marcadas como lidas no chat 6861a1354ecb7e427d55a0b7
2025-06-29 17:25:31 [info]: Mensagem enviada com sucesso no chat 6861a1354ecb7e427d55a0b7
2025-06-29 17:25:35 [error]: TypeError: Class constructor ObjectId cannot be invoked without 'new'
    at messageSchema.statics.findUnreadByUser (C:\Users\Trick\Documents\web2\src\models\Message.js:206:41)
    at ChatLibrary.getUnreadMessages (C:\Users\Trick\Documents\web2\src\index.js:283:28)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async C:\Users\Trick\Documents\web2\src\routes\chats.js:20:30
2025-06-29 17:25:39 [info]: Status do usuário arthur_lima atualizado para: offline
2025-06-29 17:28:06 [warn]: MongoDB desconectado
